---
- name: include vars for Debian
  include_vars: "os_{{ ansible_facts['distribution'] }}.yml"
  when: ansible_facts['distribution'] == 'Debian'
  
- name: Ensure Debian distibution release repo
  apt_repository:
    filename: "debian_{{ ansible_facts['distribution_release'] }}"
    repo: "deb {{ debian_repo }} {{ ansible_facts['distribution_release'] }} main contrib non-free"

- name: Ensure debian_security distribution release repo
  apt_repository:
    filename: debian_security
    repo: "deb http://security.debian.org/ {{ ansible_facts['distribution_release'] }}/updates main contrib non-free"

- name: Ensure distribution release updates repo
  apt_repository:
    filename: "{{ ansible_facts['distribution_release'] }}-updates"
    repo: "deb {{ debian_repo }} {{ ansible_facts['distribution_release'] }}-updates main contrib"

- name: install debian packages
  apt:
    name: "{{ packages_debian }}"
    state: present
    update_cache: true
  when: ansible_facts['distribution'] == 'Debian'

- name: remove no longer needed debian packages
  apt:
    name: "{{ remove_packages_debian }}"
    state: present
  when: ansible_facts['distribution'] == 'Debian'
